setwd("recomb_rates")
ratrec<-read.delim("recombRateRatJun03.txt.ORcounts")
quartz(width=7.5,height=10)
par(mfrow=c(2,1))
recORyes<-with(ratrec,subset(RecombSHRSPxBN,anyORs=="yes"))
recORno<-with(ratrec,subset(RecombSHRSPxBN,anyORs=="no"))
hist(recORno,xlim=c(0,4),xlab="RecombSHRSPxBN",main="RatJun03, Recombination rate in bins without ORs",br=20)
hist(recORyes,xlim=c(0,4),xlab="RecombSHRSPxBN",main="RatJun03, Recombination rate in bins with ORs")
summary(recORno)
summary(recORyes)
wilcox.test(RecombSHRSPxBN ~ anyORs,data=ratrec)
recORyes5ormore<-with(ratrec,subset(RecombSHRSPxBN,ORnum>=5))
recORyesno4orless<-with(ratrec,subset(RecombSHRSPxBN,ORnum<5))
hist(recORyesno4orless,xlim=c(0,4),xlab="RecombSHRSPxBN",main="RatJun03, Recombination rate in bins with 4 or fewer ORs",br=20)
hist(recORyes5ormore,xlim=c(0,4),xlab="RecombSHRSPxBN",main="RatJun03, Recombination rate in bins with 5 or more ORs")
wilcox.test(recORyes5ormore,recORyesno4orless)


recORyesF<-with(ratrec,subset(RecombFHHxACI,anyORs=="yes"))
recORnoF<-with(ratrec,subset(RecombFHHxACI,anyORs=="no"))
hist(recORnoF,xlim=c(0,4),xlab="RecombFHHxACI",main="RatJun03, Recombination rate in bins without ORs",br=20)
hist(recORyesF,xlim=c(0,4),xlab="RecombFHHxACI",main="RatJun03, Recombination rate in bins with ORs")
wilcox.test(recORyesF,recORnoF)
recORyes5ormoreF<-with(ratrec,subset(RecombFHHxACI,ORnum>=5))
recORyesno4orless<-with(ratrec,subset(RecombFHHxACI,ORnum<5))
hist(recORyesno4orlessF,xlim=c(0,4),xlab="RecombFHHxACI",main="RatJun03, Recombination rate in bins with 4 or fewer ORs, or no ORs",br=20)
hist(recORyes5ormoreF,xlim=c(0,4),xlab="RecombFHHxACI",main="RatJun03, Recombination rate in bins with 5 or more ORs")
wilcox.test(recORyes5ormoreF,recORyesno4orlessF)
summary(recORyes5ormoreF)
summary(recORyesno4orlessF)


may04rec<-read.delim("may04recombrates.txt.ORcounts")
decodeavgORyes<-with(may04rec,subset(decodeAvg,anyORs=="yes"))
decodeavgORno<-with(may04rec,subset(decodeAvg,anyORs=="no"))
hist(decodeavgORno,xlab="decodeAvg",main="HumMay04, Recombination rate in bins without ORs",xlim=c(0,8))
hist(decodeavgORyes,xlab="decodeAvg",main="HumMay04, Recombination rate in bins with ORs",br=20,xlim=c(0,8))
summary(decodeavgORyes)
summary(decodeavgORno)
wilcox.test(decodeavgORyes,decodeavgORno)
decodeavgORyes5ormore<-with(may04rec,subset(decodeAvg,ORnum>=5))
decodeavgORyesno4orless<-with(may04rec,subset(decodeAvg,ORnum<5))
hist(decodeavgORyesno4orless,xlab="decodeAvg",main="HumMay04, Recombination rate in bins with 4 or fewer ORs",xlim=c(0,8))
hist(decodeavgORyes5ormore,xlab="decodeAvg",main="HumMay04, Recombination rate in bins with 5 or more ORs",xlim=c(0,8))
wilcox.test(decodeavgORyes5ormore,decodeavgORyesno4orless)
summary(decodeavgORyesno4orless)
summary(decodeavgORyes5ormore)


hapmaprec<-read.delim("snpRecombRateHapmapMay04.txt.ORcounts")
hapmapORyes<-with(hapmaprec,subset(RecombRateHapMap,anyORs=="yes"))
hapmapORno<-with(hapmaprec,subset(RecombRateHapMap,anyORs=="no"))
hist(hapmaprec[,"RecombRateHapMap"],xlab="RecombRateHapMap",main="HumMay04, Recombination rate in all bins",breaks=c(0,1,2,3,4,5,6,7,8,9,10,20,30,40,50,60,70,80,90,100),ylim=c(0,0.1),xlim=c(0,40))
hist(hapmapORno,xlab="RecombRateHapMap",main="HumMay04, Recombination rate in bins without ORs",breaks=c(0,1,2,3,4,5,6,7,8,9,10,20,30,40,50,60,70,80,90,100),ylim=c(0,0.1),xlim=c(0,40))
hist(hapmapORyes,xlab="RecombRateHapMap",main="HumMay04, Recombination rate in bins with ORs",breaks=c(0,1,2,3,4,5,6,7,8,9,10,20,30,40,50,60,70,80,90,100),ylim=c(0,0.1),xlim=c(0,40))
summary(hapmapORno)
summary(hapmapORyes)
wilcox.test(hapmapORno,hapmapORyes)
binstarts<-hapmaprec[,"start"]
binstarts<-hapmaprec[,"end"]
ORnums<-with(hapmaprec,subset(ORnum,ORnum>0))
hist(ORnums)
binsizes<-binends-binstarts
breakvector<-c(0,500,1000,1500,2000,3000,4000,5000,10000,15000,20000,25000,30000,50000,100000,200000,400000)
hist(binsizes,breaks=breakvector,xlim=c(0,20000),main="Bin sizes in HapMap recombination data, bp")
hist(binsizes,breaks=breakvector,xlim=c(0,20000),main="Bin sizes in HapMap recombination data, bp",plot=FALSE)

perlrec<-read.delim("snpRecombRatePerlegenMay04.txt.ORcounts")
perlORyes<-with(perlrec,subset(RecombRatePerlegen,anyORs=="yes"))
perlORno<-with(perlrec,subset(RecombRatePerlegen,anyORs=="no"))
hist(perlORno,xlab="RecombRatePerlegen",main="HumMay04, Perlegen recombination rate in bins without ORs",breaks=c(0,1,2,3,4,5,6,7,8,9,10,20,30,40,50,60,70,80,90,100,110),xlim=c(0,40),ylim=c(0,0.1))
hist(perlORyes,xlab="RecombRatePerlegen",main="HumMay04, Perlegen recombination rate in bins with ORs",breaks=c(0,1,2,3,4,5,6,7,8,9,10,20,30,40,50,60,70,80,90,100,110),xlim=c(0,40),ylim=c(0,0.1))
summary(perlORno)
summary(perlORyes)
wilcox.test(perlORyes,perlORno)
breakvector<-c(0,500,1000,1500,2000,3000,4000,5000,10000,15000,20000,25000,30000,50000,100000,200000,400000,600000)
binstarts<-perlrec[,"start"]
binends<-perlrec[,"end"] + 1
binsizes<- binends - binstarts
hist (binsizes, main="Bin sizes in Perlegen recombination data, bp",xlab="bin size(bp)", breaks=breakvector,ylim=c(0,0.001),xlim=c(0,20000))


perlreconceonly<-read.delim("snpRecombRatePerlegenMay04.txt.ORcounts_countonce")
perl1ORyes<-with(perlreconceonly,subset(RecombRatePerlegen,anyORs=="yes"))
perl1ORno<-with(perlreconceonly,subset(RecombRatePerlegen,anyORs=="no"))
hist(perl1ORno,xlab="RecombRatePerlegen",main="HumMay04, Perlegen recombination rate in bins without ORs, each OR once",breaks=c(0,1,2,3,4,5,6,7,8,9,10,20,30,40,50,60,70,80,90,100,110),xlim=c(0,40),ylim=c(0,0.1))
hist(perl1ORyes,xlab="RecombRatePerlegen",main="HumMay04, Perlegen recombination rate in bins with ORs, each OR once",breaks=c(0,1,2,3,4,5,6,7,8,9,10,20,30,40,50,60,70,80,90,100,110),xlim=c(0,40),ylim=c(0,0.1))
summary(perl1ORno)
summary(perl1ORyes)
wilcox.test(perl1ORno,perl1ORyes)

hapmap1<-read.delim("snpRecombRateHapmapMay04.txt.ORcounts_countonce")
hapmap1ORyes<-with(hapmap1,subset(RecombRateHapMap,anyORs=="yes"))
hapmap1ORno<-with(hapmap1,subset(RecombRateHapMap,anyORs=="no"))
hist(hapmap1ORno,xlab="RecombRateHapMap",main="HumMay04, HapMap recombination rate in bins without ORs, each OR once",breaks=c(0,1,2,3,4,5,6,7,8,9,10,20,30,40,50,60,70,80,90,100,110),xlim=c(0,40),ylim=c(0,0.1))
hist(hapmap1ORyes,xlab="RecombRateHapMap",main="HumMay04, HapMap recombination rate in bins with ORs, each OR once",breaks=c(0,1,2,3,4,5,6,7,8,9,10,20,30,40,50,60,70,80,90,100,110),xlim=c(0,40),ylim=c(0,0.1))
summary(hapmap1ORno)
summary(hapmap1ORyes)
wilcox.test(hapmap1ORno,hapmap1ORyes)

---
title: "multiple_sequence_alignments_functions_testCode.Rmd"
author: "Janet Young\n"
date: "`r Sys.Date()`\n"
output: github_document
always_allow_html: true
---

# Goal 

Make a test alignment and some code to work on how to treat alignments with gaps and ambiguities


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(here)
library(magrittr)
library(Biostrings)
source(here("useful_functions/multiple_sequence_alignments_functions.R"))
```


Set up test DNA alignment, with in-frame gap, frameshifting gap and codons containing Ns

```{r}
testAln <- DNAStringSet(c(seq1="ATG-ACAAT---TGG",
                          seq2="ATNGANGGT---ATG",
                          seq3="ATG-ACGGTTGGATG"))
testAln
```

`getCodons` is a small function that splits each sequence into constituent codons:

```{r}
tempCodons <- getCodons(testAln)
tempCodons
```


Translate the alignment using my `translateGappedAln` function. The defaults are:

- `frameshiftTranslatesTo="X"`    (e.g. for codons containing gap and DNA base), 
- `unknownCodonTranslatesTo="-"`  (e.g. for codons containing ambiguities) 
- `quiet=FALSE` : will emit warnings

```{r}
translateGappedAln(testAln)
```

Can simply turn off the warnings:

```{r}
translateGappedAln(testAln, quiet=TRUE)
```

Can choose other translations for the ambiguous codons and frameshifts:

```{r}
translateGappedAln(testAln,
                   frameshiftTranslatesTo="b", 
                   unknownCodonTranslatesTo="z", 
                   quiet=TRUE)
```
```{r}
translateGappedAln(testAln,
                   frameshiftTranslatesTo="-", 
                   unknownCodonTranslatesTo="-", 
                   quiet=TRUE)
```
# Degapping alignments

Reminder of what the alignment looks like:

```{r}
testAln
```

```{r}
translateGappedAln(testAln, quiet=TRUE)
```

```{r}
degapAln(translateGappedAln(testAln, quiet=TRUE),
         fractionOfSeqsWithGap = 0.5)
```
```{r}
degapAln(testAln,
         fractionOfSeqsWithGap = 0.5)
```

# Finished

```{r}
sessionInfo()
```

